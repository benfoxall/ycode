import{c as $e}from"./common/error-8f9bf959.js";import{c as _t}from"./common/mutex-324572dd.js";import{c as wt,a as ge,b as Ne}from"./common/_commonjsHelpers-4f56b6ba.js";import{O as Xe,g as je,m as vt,l as Ct,s as Ie,h as Ze,v as St,i as Qe,j as Et,w as Z,k as le,r as et,n as Le,o as tt,p as Rt,d as Ue,a as Be,t as re,b as rt,c as te,q as Tt,f as At,u as nt,x as kt}from"./common/function-d4886006.js";import{e as Lt,a as Ot,b as xt,c as Nt,r as It,u as Mt,B as ae,U as Se,G as it,d as st}from"./common/yjs-d596c0e9.js";import{A as Pt,e as Me,r as ot,a as Dt}from"./common/awareness-96ffb3f7.js";const jt=1200,Ut=2500,Pe=3e4,Fe=m=>{if(m.shouldConnect&&m.ws===null){const O=new WebSocket(m.url),I=m.binaryType;let D=null;I&&(O.binaryType=I),m.ws=O,m.connecting=!0,m.connected=!1,O.onmessage=N=>{m.lastMessageReceived=je();const b=N.data,a=typeof b=="string"?JSON.parse(b):b;a&&a.type==="pong"&&(clearTimeout(D),D=setTimeout(S,Pe/2)),m.emit("message",[a,m])};const j=N=>{m.ws!==null&&(m.ws=null,m.connecting=!1,m.connected?(m.connected=!1,m.emit("disconnect",[{type:"disconnect",error:N},m])):m.unsuccessfulReconnects++,setTimeout(Fe,vt(Ct(m.unsuccessfulReconnects+1)*jt,Ut),m)),clearTimeout(D)},S=()=>{m.ws===O&&m.send({type:"ping"})};O.onclose=()=>j(null),O.onerror=N=>j(N),O.onopen=()=>{m.lastMessageReceived=je(),m.connecting=!1,m.connected=!0,m.unsuccessfulReconnects=0,m.emit("connect",[{type:"connect"},m]),D=setTimeout(S,Pe/2)}}};class Bt extends Xe{constructor(m,{binaryType:O}={}){super();this.url=m,this.ws=null,this.binaryType=O||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Pe<je()-this.lastMessageReceived&&this.ws.close()},Pe/2),Fe(this)}send(m){this.ws&&this.ws.send(JSON.stringify(m))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Fe(this)}}const Ft=m=>Promise.reject(m),We=m=>Promise.resolve(m),Wt=new Map;class qt{constructor(m){this.room=m,this.onmessage=null,addEventListener("storage",O=>O.key===m&&this.onmessage!==null&&this.onmessage({data:Ze(O.newValue||"")}))}postMessage(m){St.setItem(this.room,Qe(Et(m)))}}const Ht=typeof BroadcastChannel=="undefined"?qt:BroadcastChannel,qe=m=>Ie(Wt,m,()=>{const O=new Set,I=new Ht(m);return I.onmessage=D=>O.forEach(j=>j(D.data)),{bc:I,subs:O}}),Yt=(m,O)=>qe(m).subs.add(O),Vt=(m,O)=>qe(m).subs.delete(O),Kt=(m,O)=>{const I=qe(m);I.bc.postMessage(O),I.subs.forEach(D=>D(O))};var Gt=wt(function(m,O){(function(I){m.exports=I()})(function(){var I=Math.floor,D=Math.abs,j=Math.pow;return function(){function S(N,b,a){function R(c,l){if(!b[c]){if(!N[c]){var u=typeof Ne=="function"&&Ne;if(!l&&u)return u(c,!0);if(x)return x(c,!0);var f=new Error("Cannot find module '"+c+"'");throw f.code="MODULE_NOT_FOUND",f}var L=b[c]={exports:{}};N[c][0].call(L.exports,function(T){var n=N[c][1][T];return R(n||T)},L,L.exports,S,N,b,a)}return b[c].exports}for(var x=typeof Ne=="function"&&Ne,s=0;s<a.length;s++)R(a[s]);return R}return S}()({1:[function(S,N,b){function a(h){var g=h.length;if(0<g%4)throw new Error("Invalid string. Length must be a multiple of 4");var w=h.indexOf("=");w===-1&&(w=g);var p=w===g?0:4-w%4;return[w,p]}function R(h,g,w){return 3*(g+w)/4-w}function x(h){var g,w,p=a(h),i=p[0],y=p[1],C=new L(R(h,i,y)),k=0,B=0<y?i-4:i;for(w=0;w<B;w+=4)g=f[h.charCodeAt(w)]<<18|f[h.charCodeAt(w+1)]<<12|f[h.charCodeAt(w+2)]<<6|f[h.charCodeAt(w+3)],C[k++]=255&g>>16,C[k++]=255&g>>8,C[k++]=255&g;return y===2&&(g=f[h.charCodeAt(w)]<<2|f[h.charCodeAt(w+1)]>>4,C[k++]=255&g),y===1&&(g=f[h.charCodeAt(w)]<<10|f[h.charCodeAt(w+1)]<<4|f[h.charCodeAt(w+2)]>>2,C[k++]=255&g>>8,C[k++]=255&g),C}function s(h){return u[63&h>>18]+u[63&h>>12]+u[63&h>>6]+u[63&h]}function c(h,g,w){for(var p,i=[],y=g;y<w;y+=3)p=(16711680&h[y]<<16)+(65280&h[y+1]<<8)+(255&h[y+2]),i.push(s(p));return i.join("")}function l(h){for(var g,w=h.length,p=w%3,i=[],y=16383,C=0,k=w-p;C<k;C+=y)i.push(c(h,C,C+y>k?k:C+y));return p===1?(g=h[w-1],i.push(u[g>>2]+u[63&g<<4]+"==")):p===2&&(g=(h[w-2]<<8)+h[w-1],i.push(u[g>>10]+u[63&g>>4]+u[63&g<<2]+"=")),i.join("")}b.byteLength=function(h){var g=a(h),w=g[0],p=g[1];return 3*(w+p)/4-p},b.toByteArray=x,b.fromByteArray=l;for(var u=[],f=[],L=typeof Uint8Array=="undefined"?Array:Uint8Array,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,d=T.length;n<d;++n)u[n]=T[n],f[T.charCodeAt(n)]=n;f[45]=62,f[95]=63},{}],2:[function(){},{}],3:[function(S,N){function b(i){console&&console.warn&&console.warn(i)}function a(){a.init.call(this)}function R(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}function x(i){return i._maxListeners===void 0?a.defaultMaxListeners:i._maxListeners}function s(i,y,C,k){var B,U,K;if(R(C),U=i._events,U===void 0?(U=i._events=Object.create(null),i._eventsCount=0):(U.newListener!==void 0&&(i.emit("newListener",y,C.listener?C.listener:C),U=i._events),K=U[y]),K===void 0)K=U[y]=C,++i._eventsCount;else if(typeof K=="function"?K=U[y]=k?[C,K]:[K,C]:k?K.unshift(C):K.push(C),B=x(i),0<B&&K.length>B&&!K.warned){K.warned=!0;var X=new Error("Possible EventEmitter memory leak detected. "+K.length+" "+(y+" listeners added. Use emitter.setMaxListeners() to increase limit"));X.name="MaxListenersExceededWarning",X.emitter=i,X.type=y,X.count=K.length,b(X)}return i}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(i,y,C){var k={fired:!1,wrapFn:void 0,target:i,type:y,listener:C},B=c.bind(k);return B.listener=C,k.wrapFn=B,B}function u(i,y,C){var k=i._events;if(k===void 0)return[];var B=k[y];return B===void 0?[]:typeof B=="function"?C?[B.listener||B]:[B]:C?n(B):L(B,B.length)}function f(i){var y=this._events;if(y!==void 0){var C=y[i];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}function L(i,y){for(var C=Array(y),k=0;k<y;++k)C[k]=i[k];return C}function T(i,y){for(;y+1<i.length;y++)i[y]=i[y+1];i.pop()}function n(i){for(var y=Array(i.length),C=0;C<y.length;++C)y[C]=i[C].listener||i[C];return y}var d,h=typeof Reflect=="object"?Reflect:null,g=h&&typeof h.apply=="function"?h.apply:function(i,y,C){return Function.prototype.apply.call(i,y,C)};d=h&&typeof h.ownKeys=="function"?h.ownKeys:Object.getOwnPropertySymbols?function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:function(i){return Object.getOwnPropertyNames(i)};var w=Number.isNaN||function(i){return i!==i};N.exports=a,N.exports.once=function(i,y){return new Promise(function(C,k){function B(){U!==void 0&&i.removeListener("error",U),C([].slice.call(arguments))}var U;y!=="error"&&(U=function(K){i.removeListener(y,B),k(K)},i.once("error",U)),i.once(y,B)})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var p=10;Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(i){if(typeof i!="number"||0>i||w(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");p=i}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(i){if(typeof i!="number"||0>i||w(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this},a.prototype.getMaxListeners=function(){return x(this)},a.prototype.emit=function(i){for(var y=[],C=1;C<arguments.length;C++)y.push(arguments[C]);var k=i==="error",B=this._events;if(B!==void 0)k=k&&B.error===void 0;else if(!k)return!1;if(k){var U;if(0<y.length&&(U=y[0]),U instanceof Error)throw U;var K=new Error("Unhandled error."+(U?" ("+U.message+")":""));throw K.context=U,K}var X=B[i];if(X===void 0)return!1;if(typeof X=="function")g(X,this,y);else for(var ee=X.length,ce=L(X,ee),C=0;C<ee;++C)g(ce[C],this,y);return!0},a.prototype.addListener=function(i,y){return s(this,i,y,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(i,y){return s(this,i,y,!0)},a.prototype.once=function(i,y){return R(y),this.on(i,l(this,i,y)),this},a.prototype.prependOnceListener=function(i,y){return R(y),this.prependListener(i,l(this,i,y)),this},a.prototype.removeListener=function(i,y){var C,k,B,U,K;if(R(y),k=this._events,k===void 0)return this;if(C=k[i],C===void 0)return this;if(C===y||C.listener===y)--this._eventsCount==0?this._events=Object.create(null):(delete k[i],k.removeListener&&this.emit("removeListener",i,C.listener||y));else if(typeof C!="function"){for(B=-1,U=C.length-1;0<=U;U--)if(C[U]===y||C[U].listener===y){K=C[U].listener,B=U;break}if(0>B)return this;B===0?C.shift():T(C,B),C.length===1&&(k[i]=C[0]),k.removeListener!==void 0&&this.emit("removeListener",i,K||y)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(i){var y,C,k;if(C=this._events,C===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[i]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete C[i]),this;if(arguments.length===0){var B,U=Object.keys(C);for(k=0;k<U.length;++k)B=U[k],B==="removeListener"||this.removeAllListeners(B);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=C[i],typeof y=="function")this.removeListener(i,y);else if(y!==void 0)for(k=y.length-1;0<=k;k--)this.removeListener(i,y[k]);return this},a.prototype.listeners=function(i){return u(this,i,!0)},a.prototype.rawListeners=function(i){return u(this,i,!1)},a.listenerCount=function(i,y){return typeof i.listenerCount=="function"?i.listenerCount(y):f.call(i,y)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return 0<this._eventsCount?d(this._events):[]}},{}],4:[function(S,N,b){(function(){(function(){var a=String.fromCharCode,R=Math.min;function x(e){if(2147483647<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,r){if(typeof e=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return c(e,t,r)}function c(e,t,r){if(typeof e=="string")return L(e,t);if(ArrayBuffer.isView(e))return T(e);if(e==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(_(e,ArrayBuffer)||e&&_(e.buffer,ArrayBuffer))return n(e,t,r);if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var o=e.valueOf&&e.valueOf();if(o!=null&&o!==e)return s.from(o,t,r);var v=d(e);if(v)return v;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]=="function")return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if(typeof e!="number")throw new TypeError('"size" argument must be of type number');if(0>e)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e,t,r){return l(e),0>=e||t===void 0?x(e):typeof r=="string"?x(e).fill(t,r):x(e).fill(t)}function f(e){return l(e),x(0>e?0:0|h(e))}function L(e,t){if((typeof t!="string"||t==="")&&(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|g(e,t),o=x(r),v=o.write(e,t);return v!==r&&(o=o.slice(0,v)),o}function T(e){for(var t=0>e.length?0:0|h(e.length),r=x(t),o=0;o<t;o+=1)r[o]=255&e[o];return r}function n(e,t,r){if(0>t||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var o;return o=t===void 0&&r===void 0?new Uint8Array(e):r===void 0?new Uint8Array(e,t):new Uint8Array(e,t,r),o.__proto__=s.prototype,o}function d(e){if(s.isBuffer(e)){var t=0|h(e.length),r=x(t);return r.length===0||e.copy(r,0,0,t),r}return e.length===void 0?e.type==="Buffer"&&Array.isArray(e.data)?T(e.data):void 0:typeof e.length!="number"||A(e.length)?x(0):T(e)}function h(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|e}function g(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||_(e,ArrayBuffer))return e.byteLength;if(typeof e!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,o=2<arguments.length&&arguments[2]===!0;if(!o&&r===0)return 0;for(var v=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return he(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(v)return o?-1:he(e).length;t=(""+t).toLowerCase(),v=!0}}function w(e,t,r){var o=!1;if((t===void 0||0>t)&&(t=0),t>this.length)return"";if((r===void 0||r>this.length)&&(r=this.length),0>=r)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return de(this,t,r);case"utf8":case"utf-8":return ce(this,t,r);case"ascii":return W(this,t,r);case"latin1":case"binary":return xe(this,t,r);case"base64":return ee(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,t,r);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function p(e,t,r){var o=e[t];e[t]=e[r],e[r]=o}function i(e,t,r,o,v){if(e.length===0)return-1;if(typeof r=="string"?(o=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648),r=+r,A(r)&&(r=v?0:e.length-1),0>r&&(r=e.length+r),r>=e.length){if(v)return-1;r=e.length-1}else if(0>r)if(v)r=0;else return-1;if(typeof t=="string"&&(t=s.from(t,o)),s.isBuffer(t))return t.length===0?-1:y(e,t,r,o,v);if(typeof t=="number")return t&=255,typeof Uint8Array.prototype.indexOf=="function"?v?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,o,v);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,o,v){function E(ke,we){return P===1?ke[we]:ke.readUInt16BE(we*P)}var P=1,H=e.length,$=t.length;if(o!==void 0&&(o=(o+"").toLowerCase(),o==="ucs2"||o==="ucs-2"||o==="utf16le"||o==="utf-16le")){if(2>e.length||2>t.length)return-1;P=2,H/=2,$/=2,r/=2}var G;if(v){var Y=-1;for(G=r;G<H;G++)if(E(e,G)!==E(t,Y===-1?0:G-Y))Y!==-1&&(G-=G-Y),Y=-1;else if(Y===-1&&(Y=G),G-Y+1===$)return Y*P}else for(r+$>H&&(r=H-$),G=r;0<=G;G--){for(var V=!0,_e=0;_e<$;_e++)if(E(e,G+_e)!==E(t,_e)){V=!1;break}if(V)return G}return-1}function C(e,t,r,o){r=+r||0;var v=e.length-r;o?(o=+o,o>v&&(o=v)):o=v;var E=t.length;o>E/2&&(o=E/2);for(var P,H=0;H<o;++H){if(P=parseInt(t.substr(2*H,2),16),A(P))return H;e[r+H]=P}return H}function k(e,t,r,o){return oe(he(t,e.length-r),e,r,o)}function B(e,t,r,o){return oe(Te(t),e,r,o)}function U(e,t,r,o){return B(e,t,r,o)}function K(e,t,r,o){return oe(Q(t),e,r,o)}function X(e,t,r,o){return oe(Ae(t,e.length-r),e,r,o)}function ee(e,t,r){return t===0&&r===e.length?M.fromByteArray(e):M.fromByteArray(e.slice(t,r))}function ce(e,t,r){r=R(e.length,r);for(var o=[],v=t;v<r;){var E=e[v],P=null,H=239<E?4:223<E?3:191<E?2:1;if(v+H<=r){var $,G,Y,V;H===1?128>E&&(P=E):H===2?($=e[v+1],(192&$)==128&&(V=(31&E)<<6|63&$,127<V&&(P=V))):H===3?($=e[v+1],G=e[v+2],(192&$)==128&&(192&G)==128&&(V=(15&E)<<12|(63&$)<<6|63&G,2047<V&&(55296>V||57343<V)&&(P=V))):H===4&&($=e[v+1],G=e[v+2],Y=e[v+3],(192&$)==128&&(192&G)==128&&(192&Y)==128&&(V=(15&E)<<18|(63&$)<<12|(63&G)<<6|63&Y,65535<V&&1114112>V&&(P=V)))}P===null?(P=65533,H=1):65535<P&&(P-=65536,o.push(55296|1023&P>>>10),P=56320|1023&P),o.push(P),v+=H}return ie(o)}function ie(e){var t=e.length;if(t<=4096)return a.apply(String,e);for(var r="",o=0;o<t;)r+=a.apply(String,e.slice(o,o+=4096));return r}function W(e,t,r){var o="";r=R(e.length,r);for(var v=t;v<r;++v)o+=a(127&e[v]);return o}function xe(e,t,r){var o="";r=R(e.length,r);for(var v=t;v<r;++v)o+=a(e[v]);return o}function de(e,t,r){var o=e.length;(!t||0>t)&&(t=0),(!r||0>r||r>o)&&(r=o);for(var v="",E=t;E<r;++E)v+=Re(e[E]);return v}function ue(e,t,r){for(var o=e.slice(t,r),v="",E=0;E<o.length;E+=2)v+=a(o[E]+256*o[E+1]);return v}function z(e,t,r){if(e%1!=0||0>e)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function J(e,t,r,o,v,E){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>v||t<E)throw new RangeError('"value" argument is out of bounds');if(r+o>e.length)throw new RangeError("Index out of range")}function fe(e,t,r,o){if(r+o>e.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("Index out of range")}function se(e,t,r,o,v){return t=+t,r>>>=0,v||fe(e,t,r,4),F.write(e,t,r,o,23,4),r+4}function pe(e,t,r,o,v){return t=+t,r>>>=0,v||fe(e,t,r,8),F.write(e,t,r,o,52,8),r+8}function me(e){if(e=e.split("=")[0],e=e.trim().replace(q,""),2>e.length)return"";for(;e.length%4!=0;)e+="=";return e}function Re(e){return 16>e?"0"+e.toString(16):e.toString(16)}function he(e,t){t=t||1/0;for(var r,o=e.length,v=null,E=[],P=0;P<o;++P){if(r=e.charCodeAt(P),55295<r&&57344>r){if(!v){if(56319<r){-1<(t-=3)&&E.push(239,191,189);continue}else if(P+1===o){-1<(t-=3)&&E.push(239,191,189);continue}v=r;continue}if(56320>r){-1<(t-=3)&&E.push(239,191,189),v=r;continue}r=(v-55296<<10|r-56320)+65536}else v&&-1<(t-=3)&&E.push(239,191,189);if(v=null,128>r){if(0>(t-=1))break;E.push(r)}else if(2048>r){if(0>(t-=2))break;E.push(192|r>>6,128|63&r)}else if(65536>r){if(0>(t-=3))break;E.push(224|r>>12,128|63&r>>6,128|63&r)}else if(1114112>r){if(0>(t-=4))break;E.push(240|r>>18,128|63&r>>12,128|63&r>>6,128|63&r)}else throw new Error("Invalid code point")}return E}function Te(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function Ae(e,t){for(var r,o,v,E=[],P=0;P<e.length&&!(0>(t-=2));++P)r=e.charCodeAt(P),o=r>>8,v=r%256,E.push(v),E.push(o);return E}function Q(e){return M.toByteArray(me(e))}function oe(e,t,r,o){for(var v=0;v<o&&!(v+r>=t.length||v>=e.length);++v)t[v+r]=e[v];return v}function _(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function A(e){return e!==e}var M=S("base64-js"),F=S("ieee754");b.Buffer=s,b.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},b.INSPECT_MAX_BYTES=50,b.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},e.foo()===42}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){return s.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){return s.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol!="undefined"&&Symbol.species!=null&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,r){return c(e,t,r)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,r){return u(e,t,r)},s.allocUnsafe=function(e){return f(e)},s.allocUnsafeSlow=function(e){return f(e)},s.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==s.prototype},s.compare=function(e,t){if(_(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),_(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,o=t.length,v=0,E=R(r,o);v<E;++v)if(e[v]!==t[v]){r=e[v],o=t[v];break}return r<o?-1:o<r?1:0},s.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return s.alloc(0);var r;if(t===void 0)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var o=s.allocUnsafe(t),v=0;for(r=0;r<e.length;++r){var E=e[r];if(_(E,Uint8Array)&&(E=s.from(E)),!s.isBuffer(E))throw new TypeError('"list" argument must be an Array of Buffers');E.copy(o,v),v+=E.length}return o},s.byteLength=g,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?ce(this,0,e):w.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||s.compare(this,e)===0},s.prototype.inspect=function(){var e="",t=b.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s.prototype.compare=function(e,t,r,o,v){if(_(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),r===void 0&&(r=e?e.length:0),o===void 0&&(o=0),v===void 0&&(v=this.length),0>t||r>e.length||0>o||v>this.length)throw new RangeError("out of range index");if(o>=v&&t>=r)return 0;if(o>=v)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,o>>>=0,v>>>=0,this===e)return 0;for(var E=v-o,P=r-t,H=R(E,P),$=this.slice(o,v),G=e.slice(t,r),Y=0;Y<H;++Y)if($[Y]!==G[Y]){E=$[Y],P=G[Y];break}return E<P?-1:P<E?1:0},s.prototype.includes=function(e,t,r){return this.indexOf(e,t,r)!==-1},s.prototype.indexOf=function(e,t,r){return i(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return i(this,e,t,r,!1)},s.prototype.write=function(e,t,r,o){if(t===void 0)o="utf8",r=this.length,t=0;else if(r===void 0&&typeof t=="string")o=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,o===void 0&&(o="utf8")):(o=r,r=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var v=this.length-t;if((r===void 0||r>v)&&(r=v),0<e.length&&(0>r||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var E=!1;;)switch(o){case"hex":return C(this,e,t,r);case"utf8":case"utf-8":return k(this,e,t,r);case"ascii":return B(this,e,t,r);case"latin1":case"binary":return U(this,e,t,r);case"base64":return K(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,e,t,r);default:if(E)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),E=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(e,t){var r=this.length;e=~~e,t=t===void 0?r:~~t,0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),t<e&&(t=e);var o=this.subarray(e,t);return o.__proto__=s.prototype,o},s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var o=this[e],v=1,E=0;++E<t&&(v*=256);)o+=this[e+E]*v;return o},s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var o=this[e+--t],v=1;0<t&&(v*=256);)o+=this[e+--t]*v;return o},s.prototype.readUInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var o=this[e],v=1,E=0;++E<t&&(v*=256);)o+=this[e+E]*v;return v*=128,o>=v&&(o-=j(2,8*t)),o},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var o=t,v=1,E=this[e+--o];0<o&&(v*=256);)E+=this[e+--o]*v;return v*=128,E>=v&&(E-=j(2,8*t)),E},s.prototype.readInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||z(e,4,this.length),F.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||z(e,4,this.length),F.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||z(e,8,this.length),F.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||z(e,8,this.length),F.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,r,o){if(e=+e,t>>>=0,r>>>=0,!o){var v=j(2,8*r)-1;J(this,e,t,r,v,0)}var E=1,P=0;for(this[t]=255&e;++P<r&&(E*=256);)this[t+P]=255&e/E;return t+r},s.prototype.writeUIntBE=function(e,t,r,o){if(e=+e,t>>>=0,r>>>=0,!o){var v=j(2,8*r)-1;J(this,e,t,r,v,0)}var E=r-1,P=1;for(this[t+E]=255&e;0<=--E&&(P*=256);)this[t+E]=255&e/P;return t+r},s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,r,o){if(e=+e,t>>>=0,!o){var v=j(2,8*r-1);J(this,e,t,r,v-1,-v)}var E=0,P=1,H=0;for(this[t]=255&e;++E<r&&(P*=256);)0>e&&H===0&&this[t+E-1]!==0&&(H=1),this[t+E]=255&(e/P>>0)-H;return t+r},s.prototype.writeIntBE=function(e,t,r,o){if(e=+e,t>>>=0,!o){var v=j(2,8*r-1);J(this,e,t,r,v-1,-v)}var E=r-1,P=1,H=0;for(this[t+E]=255&e;0<=--E&&(P*=256);)0>e&&H===0&&this[t+E+1]!==0&&(H=1),this[t+E]=255&(e/P>>0)-H;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,r){return se(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return se(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return pe(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return pe(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,o){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),o||o===0||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),0<o&&o<r&&(o=r),o===r)return 0;if(e.length===0||this.length===0)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("Index out of range");if(0>o)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-r&&(o=e.length-t+r);var v=o-r;if(this===e&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(t,r,o);else if(this===e&&r<t&&t<o)for(var E=v-1;0<=E;--E)e[E+t]=this[E+r];else Uint8Array.prototype.set.call(e,this.subarray(r,o),t);return v},s.prototype.fill=function(e,t,r,o){if(typeof e=="string"){if(typeof t=="string"?(o=t,t=0,r=this.length):typeof r=="string"&&(o=r,r=this.length),o!==void 0&&typeof o!="string")throw new TypeError("encoding must be a string");if(typeof o=="string"&&!s.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(e.length===1){var v=e.charCodeAt(0);(o==="utf8"&&128>v||o==="latin1")&&(e=v)}}else typeof e=="number"&&(e&=255);if(0>t||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=r===void 0?this.length:r>>>0,e||(e=0);var E;if(typeof e=="number")for(E=t;E<r;++E)this[E]=e;else{var P=s.isBuffer(e)?e:s.from(e,o),H=P.length;if(H===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(E=0;E<r-t;++E)this[E+t]=P[E%H]}return this};var q=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,S("buffer").Buffer)},{"base64-js":1,buffer:4,ieee754:9}],5:[function(S,N,b){(function(a){(function(){function R(){let s;try{s=b.storage.getItem("debug")}catch(c){}return!s&&typeof a!="undefined"&&"env"in a&&(s=a.env.DEBUG),s}b.formatArgs=function(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+N.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;s.splice(1,0,c,"color: inherit");let l=0,u=0;s[0].replace(/%[a-zA-Z%]/g,f=>{f==="%%"||(l++,f==="%c"&&(u=l))}),s.splice(u,0,c)},b.save=function(s){try{s?b.storage.setItem("debug",s):b.storage.removeItem("debug")}catch(c){}},b.load=R,b.useColors=function(){return!!(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},b.storage=function(){try{return localStorage}catch(s){}}(),b.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],b.log=console.debug||console.log||(()=>{}),N.exports=S("./common")(b);const{formatters:x}=N.exports;x.j=function(s){try{return JSON.stringify(s)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}}).call(this)}).call(this,S("_process"))},{"./common":6,_process:12}],6:[function(S,N){N.exports=function(b){function a(c){function l(...f){if(!l.enabled)return;const L=l,T=+new Date,n=T-(u||T);L.diff=n,L.prev=u,L.curr=T,u=T,f[0]=a.coerce(f[0]),typeof f[0]!="string"&&f.unshift("%O");let d=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,(g,w)=>{if(g==="%%")return g;d++;const p=a.formatters[w];if(typeof p=="function"){const i=f[d];g=p.call(L,i),f.splice(d,1),d--}return g}),a.formatArgs.call(L,f);const h=L.log||a.log;h.apply(L,f)}let u;return l.namespace=c,l.enabled=a.enabled(c),l.useColors=a.useColors(),l.color=a.selectColor(c),l.destroy=R,l.extend=x,typeof a.init=="function"&&a.init(l),a.instances.push(l),l}function R(){const c=a.instances.indexOf(this);return c!==-1&&(a.instances.splice(c,1),!0)}function x(c,l){const u=a(this.namespace+(typeof l=="undefined"?":":l)+c);return u.log=this.log,u}function s(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(c){return c instanceof Error?c.stack||c.message:c},a.disable=function(){const c=[...a.names.map(s),...a.skips.map(s).map(l=>"-"+l)].join(",");return a.enable(""),c},a.enable=function(c){a.save(c),a.names=[],a.skips=[];let l;const u=(typeof c=="string"?c:"").split(/[\s,]+/),f=u.length;for(l=0;l<f;l++)u[l]&&(c=u[l].replace(/\*/g,".*?"),c[0]==="-"?a.skips.push(new RegExp("^"+c.substr(1)+"$")):a.names.push(new RegExp("^"+c+"$")));for(l=0;l<a.instances.length;l++){const L=a.instances[l];L.enabled=a.enabled(L.namespace)}},a.enabled=function(c){if(c[c.length-1]==="*")return!0;let l,u;for(l=0,u=a.skips.length;l<u;l++)if(a.skips[l].test(c))return!1;for(l=0,u=a.names.length;l<u;l++)if(a.names[l].test(c))return!0;return!1},a.humanize=S("ms"),Object.keys(b).forEach(c=>{a[c]=b[c]}),a.instances=[],a.names=[],a.skips=[],a.formatters={},a.selectColor=function(c){let l=0;for(let u=0;u<c.length;u++)l=(l<<5)-l+c.charCodeAt(u),l|=0;return a.colors[D(l)%a.colors.length]},a.enable(a.load()),a}},{ms:11}],7:[function(S,N){function b(a,R){for(const x in R)Object.defineProperty(a,x,{value:R[x],enumerable:!0,configurable:!0});return a}N.exports=function(a,R,x){if(!a||typeof a=="string")throw new TypeError("Please pass an Error to err-code");x||(x={}),typeof R=="object"&&(x=R,R=void 0),R!=null&&(x.code=R);try{return b(a,x)}catch(s){x.message=a.message,x.stack=a.stack;const c=function(){};return c.prototype=Object.create(Object.getPrototypeOf(a)),b(new c,x)}}},{}],8:[function(S,N){N.exports=function(){if(typeof window=="undefined")return null;var b={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return b.RTCPeerConnection?b:null}},{}],9:[function(S,N,b){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */b.read=function(a,R,x,s,c){var l,u,f=8*c-s-1,L=(1<<f)-1,T=L>>1,n=-7,d=x?c-1:0,h=x?-1:1,g=a[R+d];for(d+=h,l=g&(1<<-n)-1,g>>=-n,n+=f;0<n;l=256*l+a[R+d],d+=h,n-=8);for(u=l&(1<<-n)-1,l>>=-n,n+=s;0<n;u=256*u+a[R+d],d+=h,n-=8);if(l===0)l=1-T;else{if(l===L)return u?NaN:(g?-1:1)*(1/0);u+=j(2,s),l-=T}return(g?-1:1)*u*j(2,l-s)},b.write=function(a,R,x,s,c,l){var u,f,L,T=Math.LN2,n=Math.log,d=8*l-c-1,h=(1<<d)-1,g=h>>1,w=c===23?j(2,-24)-j(2,-77):0,p=s?0:l-1,i=s?1:-1,y=0>R||R===0&&0>1/R?1:0;for(R=D(R),isNaN(R)||R===1/0?(f=isNaN(R)?1:0,u=h):(u=I(n(R)/T),1>R*(L=j(2,-u))&&(u--,L*=2),R+=1<=u+g?w/L:w*j(2,1-g),2<=R*L&&(u++,L/=2),u+g>=h?(f=0,u=h):1<=u+g?(f=(R*L-1)*j(2,c),u+=g):(f=R*j(2,g-1)*j(2,c),u=0));8<=c;a[x+p]=255&f,p+=i,f/=256,c-=8);for(u=u<<c|f,d+=c;0<d;a[x+p]=255&u,p+=i,u/=256,d-=8);a[x+p-i]|=128*y}},{}],10:[function(S,N){N.exports=typeof Object.create=="function"?function(b,a){a&&(b.super_=a,b.prototype=Object.create(a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}))}:function(b,a){if(a){b.super_=a;var R=function(){};R.prototype=a.prototype,b.prototype=new R,b.prototype.constructor=b}}},{}],11:[function(S,N){var b=Math.round;function a(c){if(c+="",!(100<c.length)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(l){var u=parseFloat(l[1]),f=(l[2]||"ms").toLowerCase();return f==="years"||f==="year"||f==="yrs"||f==="yr"||f==="y"?315576e5*u:f==="weeks"||f==="week"||f==="w"?6048e5*u:f==="days"||f==="day"||f==="d"?864e5*u:f==="hours"||f==="hour"||f==="hrs"||f==="hr"||f==="h"?36e5*u:f==="minutes"||f==="minute"||f==="mins"||f==="min"||f==="m"?6e4*u:f==="seconds"||f==="second"||f==="secs"||f==="sec"||f==="s"?1e3*u:f==="milliseconds"||f==="millisecond"||f==="msecs"||f==="msec"||f==="ms"?u:void 0}}}function R(c){var l=D(c);return 864e5<=l?b(c/864e5)+"d":36e5<=l?b(c/36e5)+"h":6e4<=l?b(c/6e4)+"m":1e3<=l?b(c/1e3)+"s":c+"ms"}function x(c){var l=D(c);return 864e5<=l?s(c,l,864e5,"day"):36e5<=l?s(c,l,36e5,"hour"):6e4<=l?s(c,l,6e4,"minute"):1e3<=l?s(c,l,1e3,"second"):c+" ms"}function s(c,l,u,f){return b(c/u)+" "+f+(l>=1.5*u?"s":"")}N.exports=function(c,l){l=l||{};var u=typeof c;if(u=="string"&&0<c.length)return a(c);if(u==="number"&&isFinite(c))return l.long?x(c):R(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))}},{}],12:[function(S,N){function b(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function R(w){if(f===setTimeout)return setTimeout(w,0);if((f===b||!f)&&setTimeout)return f=setTimeout,setTimeout(w,0);try{return f(w,0)}catch(p){try{return f.call(null,w,0)}catch(i){return f.call(this,w,0)}}}function x(w){if(L===clearTimeout)return clearTimeout(w);if((L===a||!L)&&clearTimeout)return L=clearTimeout,clearTimeout(w);try{return L(w)}catch(p){try{return L.call(null,w)}catch(i){return L.call(this,w)}}}function s(){h&&n&&(h=!1,n.length?d=n.concat(d):g=-1,d.length&&c())}function c(){if(!h){var w=R(s);h=!0;for(var p=d.length;p;){for(n=d,d=[];++g<p;)n&&n[g].run();g=-1,p=d.length}n=null,h=!1,x(w)}}function l(w,p){this.fun=w,this.array=p}function u(){}var f,L,T=N.exports={};(function(){try{f=typeof setTimeout=="function"?setTimeout:b}catch(w){f=b}try{L=typeof clearTimeout=="function"?clearTimeout:a}catch(w){L=a}})();var n,d=[],h=!1,g=-1;T.nextTick=function(w){var p=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)p[i-1]=arguments[i];d.push(new l(w,p)),d.length!==1||h||R(c)},l.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=u,T.addListener=u,T.once=u,T.off=u,T.removeListener=u,T.removeAllListeners=u,T.emit=u,T.prependListener=u,T.prependOnceListener=u,T.listeners=function(){return[]},T.binding=function(){throw new Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(){throw new Error("process.chdir is not supported")},T.umask=function(){return 0}},{}],13:[function(S,N){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let b;N.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(globalThis):a=>(b||(b=Promise.resolve())).then(a).catch(R=>setTimeout(()=>{throw R},0))},{}],14:[function(S,N){(function(b,a){(function(){var R=S("safe-buffer").Buffer,x=a.crypto||a.msCrypto;N.exports=x&&x.getRandomValues?function(s,c){if(s>4294967295)throw new RangeError("requested too many random bytes");var l=R.allocUnsafe(s);if(0<s)if(65536<s)for(var u=0;u<s;u+=65536)x.getRandomValues(l.slice(u,u+65536));else x.getRandomValues(l);return typeof c=="function"?b.nextTick(function(){c(null,l)}):l}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,S("_process"),typeof ge=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:ge)},{_process:12,"safe-buffer":30}],15:[function(S,N){function b(u,f){u.prototype=Object.create(f.prototype),u.prototype.constructor=u,u.__proto__=f}function a(u,f,L){function T(d,h,g){return typeof f=="string"?f:f(d,h,g)}L||(L=Error);var n=function(d){function h(g,w,p){return d.call(this,T(g,w,p))||this}return b(h,d),h}(L);n.prototype.name=L.name,n.prototype.code=u,l[u]=n}function R(u,f){if(Array.isArray(u)){var L=u.length;return u=u.map(function(T){return T+""}),2<L?"one of ".concat(f," ").concat(u.slice(0,L-1).join(", "),", or ")+u[L-1]:L===2?"one of ".concat(f," ").concat(u[0]," or ").concat(u[1]):"of ".concat(f," ").concat(u[0])}return"of ".concat(f," ").concat(u+"")}function x(u,f,L){return u.substr(!L||0>L?0:+L,f.length)===f}function s(u,f,L){return(L===void 0||L>u.length)&&(L=u.length),u.substring(L-f.length,L)===f}function c(u,f,L){return typeof L!="number"&&(L=0),!(L+f.length>u.length)&&u.indexOf(f,L)!==-1}var l={};a("ERR_INVALID_OPT_VALUE",function(u,f){return'The value "'+f+'" is invalid for option "'+u+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(u,f,L){var T;typeof f=="string"&&x(f,"not ")?(T="must not be",f=f.replace(/^not /,"")):T="must be";var n;if(s(u," argument"))n="The ".concat(u," ").concat(T," ").concat(R(f,"type"));else{var d=c(u,".")?"property":"argument";n='The "'.concat(u,'" ').concat(d," ").concat(T," ").concat(R(f,"type"))}return n+=". Received type ".concat(typeof L),n},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),N.exports.codes=l},{}],16:[function(S,N){(function(b){(function(){function a(T){return this instanceof a?void(c.call(this,T),l.call(this,T),this.allowHalfOpen=!0,T&&(T.readable===!1&&(this.readable=!1),T.writable===!1&&(this.writable=!1),T.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",R)))):new a(T)}function R(){this._writableState.ended||b.nextTick(x,this)}function x(T){T.end()}var s=Object.keys||function(T){var n=[];for(var d in T)n.push(d);return n};N.exports=a;var c=S("./_stream_readable"),l=S("./_stream_writable");S("inherits")(a,c);for(var u,f=s(l.prototype),L=0;L<f.length;L++)u=f[L],a.prototype[u]||(a.prototype[u]=l.prototype[u]);Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(T){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=T,this._writableState.destroyed=T)}})}).call(this)}).call(this,S("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(S,N){function b(R){return this instanceof b?void a.call(this,R):new b(R)}N.exports=b;var a=S("./_stream_transform");S("inherits")(b,a),b.prototype._transform=function(R,x,s){s(null,R)}},{"./_stream_transform":19,inherits:10}],18:[function(S,N){(function(b,a){(function(){function R(e){return z.from(e)}function x(e){return z.isBuffer(e)||e instanceof J}function s(e,t,r){return typeof e.prependListener=="function"?e.prependListener(t,r):void(e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r))}function c(e,t,r){ie=ie||S("./_stream_duplex"),e=e||{},typeof r!="boolean"&&(r=t instanceof ie),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=Ae(this,e,"readableHighWaterMark",r),this.buffer=new Re,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=e.emitClose!==!1,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(!se&&(se=S("string_decoder/").StringDecoder),this.decoder=new se(e.encoding),this.encoding=e.encoding)}function l(e){if(ie=ie||S("./_stream_duplex"),!(this instanceof l))return new l(e);var t=this instanceof ie;this._readableState=new c(e,this,t),this.readable=!0,e&&(typeof e.read=="function"&&(this._read=e.read),typeof e.destroy=="function"&&(this._destroy=e.destroy)),ue.call(this)}function u(e,t,r,o,v){W("readableAddChunk",t);var E=e._readableState;if(t===null)E.reading=!1,d(e,E);else{var P;if(v||(P=L(E,t)),P)F(e,P);else if(!(E.objectMode||t&&0<t.length))o||(E.reading=!1,w(e,E));else if(typeof t=="string"||E.objectMode||Object.getPrototypeOf(t)===z.prototype||(t=R(t)),o)E.endEmitted?F(e,new M):f(e,E,t,!0);else if(E.ended)F(e,new _);else{if(E.destroyed)return!1;E.reading=!1,E.decoder&&!r?(t=E.decoder.write(t),E.objectMode||t.length!==0?f(e,E,t,!1):w(e,E)):f(e,E,t,!1)}}return!E.ended&&(E.length<E.highWaterMark||E.length===0)}function f(e,t,r,o){t.flowing&&t.length===0&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,o?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&h(e)),w(e,t)}function L(e,t){var r;return x(t)||typeof t=="string"||t===void 0||e.objectMode||(r=new oe("chunk",["string","Buffer","Uint8Array"],t)),r}function T(e){return 1073741824<=e?e=1073741824:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function n(e,t){return 0>=e||t.length===0&&t.ended?0:t.objectMode?1:e===e?(e>t.highWaterMark&&(t.highWaterMark=T(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)):t.flowing&&t.length?t.buffer.head.data.length:t.length}function d(e,t){if(W("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?h(e):(t.needReadable=!1,!t.emittedReadable&&(t.emittedReadable=!0,g(e)))}}function h(e){var t=e._readableState;W("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(W("emitReadable",t.flowing),t.emittedReadable=!0,b.nextTick(g,e))}function g(e){var t=e._readableState;W("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,U(e)}function w(e,t){t.readingMore||(t.readingMore=!0,b.nextTick(p,e,t))}function p(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0);){var r=t.length;if(W("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function i(e){return function(){var t=e._readableState;W("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&de(e,"data")&&(t.flowing=!0,U(e))}}function y(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function C(e){W("readable nexttick read 0"),e.read(0)}function k(e,t){t.resumeScheduled||(t.resumeScheduled=!0,b.nextTick(B,e,t))}function B(e,t){W("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),U(e),t.flowing&&!t.reading&&e.read(0)}function U(e){var t=e._readableState;for(W("flow",t.flowing);t.flowing&&e.read()!==null;);}function K(e,t){if(t.length===0)return null;var r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):t.buffer.length===1?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r}function X(e){var t=e._readableState;W("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,b.nextTick(ee,t,e))}function ee(e,t){if(W("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&e.length===0&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function ce(e,t){for(var r=0,o=e.length;r<o;r++)if(e[r]===t)return r;return-1}N.exports=l;var ie;l.ReadableState=c;var W,xe=S("events").EventEmitter,de=function(e,t){return e.listeners(t).length},ue=S("./internal/streams/stream"),z=S("buffer").Buffer,J=a.Uint8Array||function(){},fe=S("util");W=fe&&fe.debuglog?fe.debuglog("stream"):function(){};var se,pe,me,Re=S("./internal/streams/buffer_list"),he=S("./internal/streams/destroy"),Te=S("./internal/streams/state"),Ae=Te.getHighWaterMark,Q=S("../errors").codes,oe=Q.ERR_INVALID_ARG_TYPE,_=Q.ERR_STREAM_PUSH_AFTER_EOF,A=Q.ERR_METHOD_NOT_IMPLEMENTED,M=Q.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;S("inherits")(l,ue);var F=he.errorOrDestroy,q=["error","close","destroy","pause","resume"];Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),l.prototype.destroy=he.destroy,l.prototype._undestroy=he.undestroy,l.prototype._destroy=function(e,t){t(e)},l.prototype.push=function(e,t){var r,o=this._readableState;return o.objectMode?r=!0:typeof e=="string"&&(t=t||o.defaultEncoding,t!==o.encoding&&(e=z.from(e,t),t=""),r=!0),u(this,e,t,!1,r)},l.prototype.unshift=function(e){return u(this,e,null,!0,!1)},l.prototype.isPaused=function(){return this._readableState.flowing===!1},l.prototype.setEncoding=function(e){se||(se=S("string_decoder/").StringDecoder);var t=new se(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,o="";r!==null;)o+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),o!==""&&this._readableState.buffer.push(o),this._readableState.length=o.length,this},l.prototype.read=function(e){W("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(e!==0&&(t.emittedReadable=!1),e===0&&t.needReadable&&((t.highWaterMark===0?0<t.length:t.length>=t.highWaterMark)||t.ended))return W("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?X(this):h(this),null;if(e=n(e,t),e===0&&t.ended)return t.length===0&&X(this),null;var o=t.needReadable;W("need readable",o),(t.length===0||t.length-e<t.highWaterMark)&&(o=!0,W("length less than watermark",o)),t.ended||t.reading?(o=!1,W("reading or ended",o)):o&&(W("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,!t.reading&&(e=n(r,t)));var v;return v=0<e?K(e,t):null,v===null?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),t.length===0&&(!t.ended&&(t.needReadable=!0),r!==e&&t.ended&&X(this)),v!==null&&this.emit("data",v),v},l.prototype._read=function(){F(this,new A("_read()"))},l.prototype.pipe=function(e,t){function r(ve,Ce){W("onunpipe"),ve===Y&&Ce&&Ce.hasUnpiped===!1&&(Ce.hasUnpiped=!0,v())}function o(){W("onend"),e.end()}function v(){W("cleanup"),e.removeListener("close",H),e.removeListener("finish",$),e.removeListener("drain",we),e.removeListener("error",P),e.removeListener("unpipe",r),Y.removeListener("end",o),Y.removeListener("end",G),Y.removeListener("data",E),Je=!0,V.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&we()}function E(ve){W("ondata");var Ce=e.write(ve);W("dest.write",Ce),Ce===!1&&((V.pipesCount===1&&V.pipes===e||1<V.pipesCount&&ce(V.pipes,e)!==-1)&&!Je&&(W("false write response, pause",V.awaitDrain),V.awaitDrain++),Y.pause())}function P(ve){W("onerror",ve),G(),e.removeListener("error",P),de(e,"error")===0&&F(e,ve)}function H(){e.removeListener("finish",$),G()}function $(){W("onfinish"),e.removeListener("close",H),G()}function G(){W("unpipe"),Y.unpipe(e)}var Y=this,V=this._readableState;switch(V.pipesCount){case 0:V.pipes=e;break;case 1:V.pipes=[V.pipes,e];break;default:V.pipes.push(e)}V.pipesCount+=1,W("pipe count=%d opts=%j",V.pipesCount,t);var _e=(!t||t.end!==!1)&&e!==b.stdout&&e!==b.stderr,ke=_e?o:G;V.endEmitted?b.nextTick(ke):Y.once("end",ke),e.on("unpipe",r);var we=i(Y);e.on("drain",we);var Je=!1;return Y.on("data",E),s(e,"error",P),e.once("close",H),e.once("finish",$),e.emit("pipe",Y),V.flowing||(W("pipe resume"),Y.resume()),e},l.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(t.pipesCount===0)return this;if(t.pipesCount===1)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var o=t.pipes,v=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var E=0;E<v;E++)o[E].emit("unpipe",this,{hasUnpiped:!1});return this}var P=ce(t.pipes,e);return P===-1?this:(t.pipes.splice(P,1),t.pipesCount-=1,t.pipesCount===1&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},l.prototype.on=function(e,t){var r=ue.prototype.on.call(this,e,t),o=this._readableState;return e==="data"?(o.readableListening=0<this.listenerCount("readable"),o.flowing!==!1&&this.resume()):e=="readable"&&!o.endEmitted&&!o.readableListening&&(o.readableListening=o.needReadable=!0,o.flowing=!1,o.emittedReadable=!1,W("on readable",o.length,o.reading),o.length?h(this):!o.reading&&b.nextTick(C,this)),r},l.prototype.addListener=l.prototype.on,l.prototype.removeListener=function(e,t){var r=ue.prototype.removeListener.call(this,e,t);return e==="readable"&&b.nextTick(y,this),r},l.prototype.removeAllListeners=function(e){var t=ue.prototype.removeAllListeners.apply(this,arguments);return(e==="readable"||e===void 0)&&b.nextTick(y,this),t},l.prototype.resume=function(){var e=this._readableState;return e.flowing||(W("resume"),e.flowing=!e.readableListening,k(this,e)),e.paused=!1,this},l.prototype.pause=function(){return W("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(W("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},l.prototype.wrap=function(e){var t=this,r=this._readableState,o=!1;for(var v in e.on("end",function(){if(W("wrapped end"),r.decoder&&!r.ended){var P=r.decoder.end();P&&P.length&&t.push(P)}t.push(null)}),e.on("data",function(P){if((W("wrapped data"),r.decoder&&(P=r.decoder.write(P)),!(r.objectMode&&P==null))&&(r.objectMode||P&&P.length)){var H=t.push(P);H||(o=!0,e.pause())}}),e)this[v]===void 0&&typeof e[v]=="function"&&(this[v]=function(P){return function(){return e[P].apply(e,arguments)}}(v));for(var E=0;E<q.length;E++)e.on(q[E],this.emit.bind(this,q[E]));return this._read=function(P){W("wrapped _read",P),o&&(o=!1,e.resume())},this},typeof Symbol=="function"&&(l.prototype[Symbol.asyncIterator]=function(){return pe===void 0&&(pe=S("./internal/streams/async_iterator")),pe(this)}),Object.defineProperty(l.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(l.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(l.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),l._fromList=K,Object.defineProperty(l.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(l.from=function(e,t){return me===void 0&&(me=S("./internal/streams/from")),me(l,e,t)})}).call(this)}).call(this,S("_process"),typeof ge=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:ge)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:4,events:3,inherits:10,"string_decoder/":31,util:2}],19:[function(S,N){function b(T,n){var d=this._transformState;d.transforming=!1;var h=d.writecb;if(h===null)return this.emit("error",new l);d.writechunk=null,d.writecb=null,n!=null&&this.push(n),h(T);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function a(T){return this instanceof a?void(L.call(this,T),this._transformState={afterTransform:b.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,T&&(typeof T.transform=="function"&&(this._transform=T.transform),typeof T.flush=="function"&&(this._flush=T.flush)),this.on("prefinish",R)):new a(T)}function R(){var T=this;typeof this._flush!="function"||this._readableState.destroyed?x(this,null,null):this._flush(function(n,d){x(T,n,d)})}function x(T,n,d){if(n)return T.emit("error",n);if(d!=null&&T.push(d),T._writableState.length)throw new f;if(T._transformState.transforming)throw new u;return T.push(null)}N.exports=a;var s=S("../errors").codes,c=s.ERR_METHOD_NOT_IMPLEMENTED,l=s.ERR_MULTIPLE_CALLBACK,u=s.ERR_TRANSFORM_ALREADY_TRANSFORMING,f=s.ERR_TRANSFORM_WITH_LENGTH_0,L=S("./_stream_duplex");S("inherits")(a,L),a.prototype.push=function(T,n){return this._transformState.needTransform=!1,L.prototype.push.call(this,T,n)},a.prototype._transform=function(T,n,d){d(new c("_transform()"))},a.prototype._write=function(T,n,d){var h=this._transformState;if(h.writecb=d,h.writechunk=T,h.writeencoding=n,!h.transforming){var g=this._readableState;(h.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},a.prototype._read=function(){var T=this._transformState;T.writechunk===null||T.transforming?T.needTransform=!0:(T.transforming=!0,this._transform(T.writechunk,T.writeencoding,T.afterTransform))},a.prototype._destroy=function(T,n){L.prototype._destroy.call(this,T,function(d){n(d)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(S,N){(function(b,a){(function(){function R(_){var A=this;this.next=null,this.entry=null,this.finish=function(){X(A,_)}}function x(_){return W.from(_)}function s(_){return W.isBuffer(_)||_ instanceof xe}function c(){}function l(_,A,M){ee=ee||S("./_stream_duplex"),_=_||{},typeof M!="boolean"&&(M=A instanceof ee),this.objectMode=!!_.objectMode,M&&(this.objectMode=this.objectMode||!!_.writableObjectMode),this.highWaterMark=z(this,_,"writableHighWaterMark",M),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var F=_.decodeStrings===!1;this.decodeStrings=!F,this.defaultEncoding=_.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(q){w(A,q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=_.emitClose!==!1,this.autoDestroy=!!_.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new R(this)}function u(_){ee=ee||S("./_stream_duplex");var A=this instanceof ee;return A||oe.call(u,this)?void(this._writableState=new l(_,this,A),this.writable=!0,_&&(typeof _.write=="function"&&(this._write=_.write),typeof _.writev=="function"&&(this._writev=_.writev),typeof _.destroy=="function"&&(this._destroy=_.destroy),typeof _.final=="function"&&(this._final=_.final)),ie.call(this)):new u(_)}function f(_,A){var M=new Te;Q(_,M),b.nextTick(A,M)}function L(_,A,M,F){var q;return M===null?q=new he:typeof M!="string"&&!A.objectMode&&(q=new fe("chunk",["string","Buffer"],M)),!q||(Q(_,q),b.nextTick(F,q),!1)}function T(_,A,M){return _.objectMode||_.decodeStrings===!1||typeof A!="string"||(A=W.from(A,M)),A}function n(_,A,M,F,q,e){if(!M){var t=T(A,F,q);F!==t&&(M=!0,q="buffer",F=t)}var r=A.objectMode?1:F.length;A.length+=r;var o=A.length<A.highWaterMark;if(o||(A.needDrain=!0),A.writing||A.corked){var v=A.lastBufferedRequest;A.lastBufferedRequest={chunk:F,encoding:q,isBuf:M,callback:e,next:null},v?v.next=A.lastBufferedRequest:A.bufferedRequest=A.lastBufferedRequest,A.bufferedRequestCount+=1}else d(_,A,!1,r,F,q,e);return o}function d(_,A,M,F,q,e,t){A.writelen=F,A.writecb=t,A.writing=!0,A.sync=!0,A.destroyed?A.onwrite(new Re("write")):M?_._writev(q,A.onwrite):_._write(q,e,A.onwrite),A.sync=!1}function h(_,A,M,F,q){--A.pendingcb,M?(b.nextTick(q,F),b.nextTick(U,_,A),_._writableState.errorEmitted=!0,Q(_,F)):(q(F),_._writableState.errorEmitted=!0,Q(_,F),U(_,A))}function g(_){_.writing=!1,_.writecb=null,_.length-=_.writelen,_.writelen=0}function w(_,A){var M=_._writableState,F=M.sync,q=M.writecb;if(typeof q!="function")throw new pe;if(g(M),A)h(_,M,F,A,q);else{var e=C(M)||_.destroyed;e||M.corked||M.bufferProcessing||!M.bufferedRequest||y(_,M),F?b.nextTick(p,_,M,e,q):p(_,M,e,q)}}function p(_,A,M,F){M||i(_,A),A.pendingcb--,F(),U(_,A)}function i(_,A){A.length===0&&A.needDrain&&(A.needDrain=!1,_.emit("drain"))}function y(_,A){A.bufferProcessing=!0;var M=A.bufferedRequest;if(_._writev&&M&&M.next){var F=A.bufferedRequestCount,q=Array(F),e=A.corkedRequestsFree;e.entry=M;for(var t=0,r=!0;M;)q[t]=M,M.isBuf||(r=!1),M=M.next,t+=1;q.allBuffers=r,d(_,A,!0,A.length,q,"",e.finish),A.pendingcb++,A.lastBufferedRequest=null,e.next?(A.corkedRequestsFree=e.next,e.next=null):A.corkedRequestsFree=new R(A),A.bufferedRequestCount=0}else{for(;M;){var o=M.chunk,v=M.encoding,E=M.callback,P=A.objectMode?1:o.length;if(d(_,A,!1,P,o,v,E),M=M.next,A.bufferedRequestCount--,A.writing)break}M===null&&(A.lastBufferedRequest=null)}A.bufferedRequest=M,A.bufferProcessing=!1}function C(_){return _.ending&&_.length===0&&_.bufferedRequest===null&&!_.finished&&!_.writing}function k(_,A){_._final(function(M){A.pendingcb--,M&&Q(_,M),A.prefinished=!0,_.emit("prefinish"),U(_,A)})}function B(_,A){A.prefinished||A.finalCalled||(typeof _._final!="function"||A.destroyed?(A.prefinished=!0,_.emit("prefinish")):(A.pendingcb++,A.finalCalled=!0,b.nextTick(k,_,A)))}function U(_,A){var M=C(A);if(M&&(B(_,A),A.pendingcb===0&&(A.finished=!0,_.emit("finish"),A.autoDestroy))){var F=_._readableState;(!F||F.autoDestroy&&F.endEmitted)&&_.destroy()}return M}function K(_,A,M){A.ending=!0,U(_,A),M&&(A.finished?b.nextTick(M):_.once("finish",M)),A.ended=!0,_.writable=!1}function X(_,A,M){var F=_.entry;for(_.entry=null;F;){var q=F.callback;A.pendingcb--,q(M),F=F.next}A.corkedRequestsFree.next=_}N.exports=u;var ee;u.WritableState=l;var ce={deprecate:S("util-deprecate")},ie=S("./internal/streams/stream"),W=S("buffer").Buffer,xe=a.Uint8Array||function(){},de=S("./internal/streams/destroy"),ue=S("./internal/streams/state"),z=ue.getHighWaterMark,J=S("../errors").codes,fe=J.ERR_INVALID_ARG_TYPE,se=J.ERR_METHOD_NOT_IMPLEMENTED,pe=J.ERR_MULTIPLE_CALLBACK,me=J.ERR_STREAM_CANNOT_PIPE,Re=J.ERR_STREAM_DESTROYED,he=J.ERR_STREAM_NULL_VALUES,Te=J.ERR_STREAM_WRITE_AFTER_END,Ae=J.ERR_UNKNOWN_ENCODING,Q=de.errorOrDestroy;S("inherits")(u,ie),l.prototype.getBuffer=function(){for(var _=this.bufferedRequest,A=[];_;)A.push(_),_=_.next;return A},function(){try{Object.defineProperty(l.prototype,"buffer",{get:ce.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_){}}();var oe;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(oe=Function.prototype[Symbol.hasInstance],Object.defineProperty(u,Symbol.hasInstance,{value:function(_){return!!oe.call(this,_)||!(this!==u)&&_&&_._writableState instanceof l}})):oe=function(_){return _ instanceof this},u.prototype.pipe=function(){Q(this,new me)},u.prototype.write=function(_,A,M){var F=this._writableState,q=!1,e=!F.objectMode&&s(_);return e&&!W.isBuffer(_)&&(_=x(_)),typeof A=="function"&&(M=A,A=null),e?A="buffer":!A&&(A=F.defaultEncoding),typeof M!="function"&&(M=c),F.ending?f(this,M):(e||L(this,F,_,M))&&(F.pendingcb++,q=n(this,F,e,_,A,M)),q},u.prototype.cork=function(){this._writableState.corked++},u.prototype.uncork=function(){var _=this._writableState;_.corked&&(_.corked--,!_.writing&&!_.corked&&!_.bufferProcessing&&_.bufferedRequest&&y(this,_))},u.prototype.setDefaultEncoding=function(_){if(typeof _=="string"&&(_=_.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((_+"").toLowerCase())))throw new Ae(_);return this._writableState.defaultEncoding=_,this},Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),u.prototype._write=function(_,A,M){M(new se("_write()"))},u.prototype._writev=null,u.prototype.end=function(_,A,M){var F=this._writableState;return typeof _=="function"?(M=_,_=null,A=null):typeof A=="function"&&(M=A,A=null),_!=null&&this.write(_,A),F.corked&&(F.corked=1,this.uncork()),F.ending||K(this,F,M),this},Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(_){this._writableState&&(this._writableState.destroyed=_)}}),u.prototype.destroy=de.destroy,u.prototype._undestroy=de.undestroy,u.prototype._destroy=function(_,A){A(_)}}).call(this)}).call(this,S("_process"),typeof ge=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:ge)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:4,inherits:10,"util-deprecate":32}],21:[function(S,N){(function(b){(function(){function a(i,y,C){return y in i?Object.defineProperty(i,y,{value:C,enumerable:!0,configurable:!0,writable:!0}):i[y]=C,i}function R(i,y){return{value:i,done:y}}function x(i){var y=i[f];if(y!==null){var C=i[g].read();C!==null&&(i[d]=null,i[f]=null,i[L]=null,y(R(C,!1)))}}function s(i){b.nextTick(x,i)}function c(i,y){return function(C,k){i.then(function(){return y[n]?void C(R(void 0,!0)):void y[h](C,k)},k)}}var l,u=S("./end-of-stream"),f=Symbol("lastResolve"),L=Symbol("lastReject"),T=Symbol("error"),n=Symbol("ended"),d=Symbol("lastPromise"),h=Symbol("handlePromise"),g=Symbol("stream"),w=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((l={get stream(){return this[g]},next:function(){var i=this,y=this[T];if(y!==null)return Promise.reject(y);if(this[n])return Promise.resolve(R(void 0,!0));if(this[g].destroyed)return new Promise(function(U,K){b.nextTick(function(){i[T]?K(i[T]):U(R(void 0,!0))})});var C,k=this[d];if(k)C=new Promise(c(k,this));else{var B=this[g].read();if(B!==null)return Promise.resolve(R(B,!1));C=new Promise(this[h])}return this[d]=C,C}},a(l,Symbol.asyncIterator,function(){return this}),a(l,"return",function(){var i=this;return new Promise(function(y,C){i[g].destroy(null,function(k){return k?void C(k):void y(R(void 0,!0))})})}),l),w);N.exports=function(i){var y,C=Object.create(p,(y={},a(y,g,{value:i,writable:!0}),a(y,f,{value:null,writable:!0}),a(y,L,{value:null,writable:!0}),a(y,T,{value:null,writable:!0}),a(y,n,{value:i._readableState.endEmitted,writable:!0}),a(y,h,{value:function(k,B){var U=C[g].read();U?(C[d]=null,C[f]=null,C[L]=null,k(R(U,!1))):(C[f]=k,C[L]=B)},writable:!0}),y));return C[d]=null,u(i,function(k){if(k&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"){var B=C[L];return B!==null&&(C[d]=null,C[f]=null,C[L]=null,B(k)),void(C[T]=k)}var U=C[f];U!==null&&(C[d]=null,C[f]=null,C[L]=null,U(R(void 0,!0))),C[n]=!0}),i.on("readable",s.bind(null,C)),C}}).call(this)}).call(this,S("_process"))},{"./end-of-stream":24,_process:12}],22:[function(S,N){function b(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(d);h&&(w=w.filter(function(p){return Object.getOwnPropertyDescriptor(d,p).enumerable})),g.push.apply(g,w)}return g}function a(d){for(var h,g=1;g<arguments.length;g++)h=arguments[g]==null?{}:arguments[g],g%2?b(Object(h),!0).forEach(function(w){R(d,w,h[w])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(h)):b(Object(h)).forEach(function(w){Object.defineProperty(d,w,Object.getOwnPropertyDescriptor(h,w))});return d}function R(d,h,g){return h in d?Object.defineProperty(d,h,{value:g,enumerable:!0,configurable:!0,writable:!0}):d[h]=g,d}function x(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")}function s(d,h){for(var g,w=0;w<h.length;w++)g=h[w],g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}function c(d,h,g){return h&&s(d.prototype,h),g&&s(d,g),d}function l(d,h,g){f.prototype.copy.call(d,h,g)}var u=S("buffer"),f=u.Buffer,L=S("util"),T=L.inspect,n=T&&T.custom||"inspect";N.exports=function(){function d(){x(this,d),this.head=null,this.tail=null,this.length=0}return c(d,[{key:"push",value:function(h){var g={data:h,next:null};0<this.length?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(h){var g={data:h,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var h=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,h}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(h){if(this.length===0)return"";for(var g=this.head,w=""+g.data;g=g.next;)w+=h+g.data;return w}},{key:"concat",value:function(h){if(this.length===0)return f.alloc(0);for(var g=f.allocUnsafe(h>>>0),w=this.head,p=0;w;)l(w.data,g,p),p+=w.data.length,w=w.next;return g}},{key:"consume",value:function(h,g){var w;return h<this.head.data.length?(w=this.head.data.slice(0,h),this.head.data=this.head.data.slice(h)):h===this.head.data.length?w=this.shift():w=g?this._getString(h):this._getBuffer(h),w}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(h){var g=this.head,w=1,p=g.data;for(h-=p.length;g=g.next;){var i=g.data,y=h>i.length?i.length:h;if(p+=y===i.length?i:i.slice(0,h),h-=y,h===0){y===i.length?(++w,this.head=g.next?g.next:this.tail=null):(this.head=g,g.data=i.slice(y));break}++w}return this.length-=w,p}},{key:"_getBuffer",value:function(h){var g=f.allocUnsafe(h),w=this.head,p=1;for(w.data.copy(g),h-=w.data.length;w=w.next;){var i=w.data,y=h>i.length?i.length:h;if(i.copy(g,g.length-h,0,y),h-=y,h===0){y===i.length?(++p,this.head=w.next?w.next:this.tail=null):(this.head=w,w.data=i.slice(y));break}++p}return this.length-=p,g}},{key:n,value:function(h,g){return T(this,a({},g,{depth:0,customInspect:!1}))}}]),d}()},{buffer:4,util:2}],23:[function(S,N){(function(b){(function(){function a(s,c){x(s,c),R(s)}function R(s){s._writableState&&!s._writableState.emitClose||s._readableState&&!s._readableState.emitClose||s.emit("close")}function x(s,c){s.emit("error",c)}N.exports={destroy:function(s,c){var l=this,u=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return u||f?(c?c(s):s&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,b.nextTick(x,this,s)):b.nextTick(x,this,s)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(s||null,function(L){!c&&L?l._writableState?l._writableState.errorEmitted?b.nextTick(R,l):(l._writableState.errorEmitted=!0,b.nextTick(a,l,L)):b.nextTick(a,l,L):c?(b.nextTick(R,l),c(L)):b.nextTick(R,l)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(s,c){var l=s._readableState,u=s._writableState;l&&l.autoDestroy||u&&u.autoDestroy?s.destroy(c):s.emit("error",c)}}}).call(this)}).call(this,S("_process"))},{_process:12}],24:[function(S,N){function b(c){var l=!1;return function(){if(!l){l=!0;for(var u=arguments.length,f=Array(u),L=0;L<u;L++)f[L]=arguments[L];c.apply(this,f)}}}function a(){}function R(c){return c.setHeader&&typeof c.abort=="function"}function x(c,l,u){if(typeof l=="function")return x(c,null,l);l||(l={}),u=b(u||a);var f=l.readable||l.readable!==!1&&c.readable,L=l.writable||l.writable!==!1&&c.writable,T=function(){c.writable||d()},n=c._writableState&&c._writableState.finished,d=function(){L=!1,n=!0,f||u.call(c)},h=c._readableState&&c._readableState.endEmitted,g=function(){f=!1,h=!0,L||u.call(c)},w=function(y){u.call(c,y)},p=function(){var y;return f&&!h?(c._readableState&&c._readableState.ended||(y=new s),u.call(c,y)):L&&!n?(c._writableState&&c._writableState.ended||(y=new s),u.call(c,y)):void 0},i=function(){c.req.on("finish",d)};return R(c)?(c.on("complete",d),c.on("abort",p),c.req?i():c.on("request",i)):L&&!c._writableState&&(c.on("end",T),c.on("close",T)),c.on("end",g),c.on("finish",d),l.error!==!1&&c.on("error",w),c.on("close",p),function(){c.removeListener("complete",d),c.removeListener("abort",p),c.removeListener("request",i),c.req&&c.req.removeListener("finish",d),c.removeListener("end",T),c.removeListener("close",T),c.removeListener("finish",d),c.removeListener("end",g),c.removeListener("error",w),c.removeListener("close",p)}}var s=S("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;N.exports=x},{"../../../errors":15}],25:[function(S,N){N.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(S,N){function b(n){var d=!1;return function(){d||(d=!0,n.apply(void 0,arguments))}}function a(n){if(n)throw n}function R(n){return n.setHeader&&typeof n.abort=="function"}function x(n,d,h,g){g=b(g);var w=!1;n.on("close",function(){w=!0}),u===void 0&&(u=S("./end-of-stream")),u(n,{readable:d,writable:h},function(i){return i?g(i):void(w=!0,g())});var p=!1;return function(i){if(!w)return p?void 0:(p=!0,R(n)?n.abort():typeof n.destroy=="function"?n.destroy():void g(i||new T("pipe")))}}function s(n){n()}function c(n,d){return n.pipe(d)}function l(n){return n.length&&typeof n[n.length-1]=="function"?n.pop():a}var u,f=S("../../../errors").codes,L=f.ERR_MISSING_ARGS,T=f.ERR_STREAM_DESTROYED;N.exports=function(){for(var n=arguments.length,d=Array(n),h=0;h<n;h++)d[h]=arguments[h];var g=l(d);if(Array.isArray(d[0])&&(d=d[0]),2>d.length)throw new L("streams");var w,p=d.map(function(i,y){var C=y<d.length-1;return x(i,C,0<y,function(k){w||(w=k),k&&p.forEach(s),C||(p.forEach(s),g(w))})});return d.reduce(c)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(S,N){function b(R,x,s){return R.highWaterMark==null?x?R[s]:null:R.highWaterMark}var a=S("../../../errors").codes.ERR_INVALID_OPT_VALUE;N.exports={getHighWaterMark:function(R,x,s,c){var l=b(x,c,s);if(l!=null){if(!(isFinite(l)&&I(l)===l)||0>l){var u=c?s:"highWaterMark";throw new a(u,l)}return I(l)}return R.objectMode?16:16384}}},{"../../../errors":15}],28:[function(S,N){N.exports=S("events").EventEmitter},{events:3}],29:[function(S,N,b){b=N.exports=S("./lib/_stream_readable.js"),b.Stream=b,b.Readable=b,b.Writable=S("./lib/_stream_writable.js"),b.Duplex=S("./lib/_stream_duplex.js"),b.Transform=S("./lib/_stream_transform.js"),b.PassThrough=S("./lib/_stream_passthrough.js"),b.finished=S("./lib/internal/streams/end-of-stream.js"),b.pipeline=S("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(S,N,b){function a(c,l){for(var u in c)l[u]=c[u]}function R(c,l,u){return s(c,l,u)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var x=S("buffer"),s=x.Buffer;s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?N.exports=x:(a(x,b),b.Buffer=R),R.prototype=Object.create(s.prototype),a(s,R),R.from=function(c,l,u){if(typeof c=="number")throw new TypeError("Argument must not be a number");return s(c,l,u)},R.alloc=function(c,l,u){if(typeof c!="number")throw new TypeError("Argument must be a number");var f=s(c);return l===void 0?f.fill(0):typeof u=="string"?f.fill(l,u):f.fill(l),f},R.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return s(c)},R.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return x.SlowBuffer(c)}},{buffer:4}],31:[function(S,N,b){function a(p){if(!p)return"utf8";for(var i;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(i)return;p=(""+p).toLowerCase(),i=!0}}function R(p){var i=a(p);if(typeof i!="string"&&(g.isEncoding===w||!w(p)))throw new Error("Unknown encoding: "+p);return i||p}function x(p){this.encoding=R(p);var i;switch(this.encoding){case"utf16le":this.text=f,this.end=L,i=4;break;case"utf8":this.fillLast=u,i=4;break;case"base64":this.text=T,this.end=n,i=3;break;default:return this.write=d,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(i)}function s(p){return 127>=p?0:p>>5==6?2:p>>4==14?3:p>>3==30?4:p>>6==2?-1:-2}function c(p,i,y){var C=i.length-1;if(C<y)return 0;var k=s(i[C]);return 0<=k?(0<k&&(p.lastNeed=k-1),k):--C<y||k===-2?0:(k=s(i[C]),0<=k)?(0<k&&(p.lastNeed=k-2),k):--C<y||k===-2?0:(k=s(i[C]),0<=k?(0<k&&(k===2?k=0:p.lastNeed=k-3),k):0)}function l(p,i){if((192&i[0])!=128)return p.lastNeed=0,"\uFFFD";if(1<p.lastNeed&&1<i.length){if((192&i[1])!=128)return p.lastNeed=1,"\uFFFD";if(2<p.lastNeed&&2<i.length&&(192&i[2])!=128)return p.lastNeed=2,"\uFFFD"}}function u(p){var i=this.lastTotal-this.lastNeed,y=l(this,p);return y===void 0?this.lastNeed<=p.length?(p.copy(this.lastChar,i,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(p.copy(this.lastChar,i,0,p.length),this.lastNeed-=p.length):y}function f(p,i){if((p.length-i)%2==0){var y=p.toString("utf16le",i);if(y){var C=y.charCodeAt(y.length-1);if(55296<=C&&56319>=C)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=p[p.length-1],p.toString("utf16le",i,p.length-1)}function L(p){var i=p&&p.length?this.write(p):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return i+this.lastChar.toString("utf16le",0,y)}return i}function T(p,i){var y=(p.length-i)%3;return y==0?p.toString("base64",i):(this.lastNeed=3-y,this.lastTotal=3,y==1?this.lastChar[0]=p[p.length-1]:(this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1]),p.toString("base64",i,p.length-y))}function n(p){var i=p&&p.length?this.write(p):"";return this.lastNeed?i+this.lastChar.toString("base64",0,3-this.lastNeed):i}function d(p){return p.toString(this.encoding)}function h(p){return p&&p.length?this.write(p):""}var g=S("safe-buffer").Buffer,w=g.isEncoding||function(p){switch(p=""+p,p&&p.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};b.StringDecoder=x,x.prototype.write=function(p){if(p.length===0)return"";var i,y;if(this.lastNeed){if(i=this.fillLast(p),i===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<p.length?i?i+this.text(p,y):this.text(p,y):i||""},x.prototype.end=function(p){var i=p&&p.length?this.write(p):"";return this.lastNeed?i+"\uFFFD":i},x.prototype.text=function(p,i){var y=c(this,p,i);if(!this.lastNeed)return p.toString("utf8",i);this.lastTotal=y;var C=p.length-(y-this.lastNeed);return p.copy(this.lastChar,0,C),p.toString("utf8",i,C)},x.prototype.fillLast=function(p){return this.lastNeed<=p.length?(p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,p.length),this.lastNeed-=p.length)}},{"safe-buffer":30}],32:[function(S,N){(function(b){(function(){function a(R){try{if(!b.localStorage)return!1}catch(s){return!1}var x=b.localStorage[R];return x!=null&&(x+"").toLowerCase()==="true"}N.exports=function(R,x){function s(){if(!c){if(a("throwDeprecation"))throw new Error(x);a("traceDeprecation")?console.trace(x):console.warn(x),c=!0}return R.apply(this,arguments)}if(a("noDeprecation"))return R;var c=!1;return s}}).call(this)}).call(this,typeof ge=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:ge)},{}],"/":[function(S,N){(function(b){(function(){function a(n){return n.replace(/a=ice-options:trickle\s\n/g,"")}function R(n){console.warn(n)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var x=S("debug")("simple-peer"),s=S("get-browser-rtc"),c=S("randombytes"),l=S("readable-stream"),u=S("queue-microtask"),f=S("err-code"),L=65536;class T extends l.Duplex{constructor(n){if(n=Object.assign({allowHalfOpen:!1},n),super(n),this._id=c(4).toString("hex").slice(0,7),this._debug("new peer %o",n),this.channelName=n.initiator?n.channelName||c(20).toString("hex"):null,this.initiator=n.initiator||!1,this.channelConfig=n.channelConfig||T.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},T.config,n.config),this.offerOptions=n.offerOptions||{},this.answerOptions=n.answerOptions||{},this.sdpTransform=n.sdpTransform||(d=>d),this.streams=n.streams||(n.stream?[n.stream]:[]),this.trickle=n.trickle===void 0||n.trickle,this.allowHalfTrickle=n.allowHalfTrickle!==void 0&&n.allowHalfTrickle,this.iceCompleteTimeout=n.iceCompleteTimeout||5e3,this.destroyed=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=n.wrtc&&typeof n.wrtc=="object"?n.wrtc:s(),!this._wrtc)throw typeof window=="undefined"?f(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):f(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(d){return void u(()=>this.destroy(f(d,"ERR_PC_CONSTRUCTOR")))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=d=>{this._onIceCandidate(d)},this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=d=>{this._setupData(d)},this.streams&&this.streams.forEach(d=>{this.addStream(d)}),this._pc.ontrack=d=>{this._onTrack(d)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(n){if(this.destroyed)throw f(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof n=="string")try{n=JSON.parse(n)}catch(d){n={}}this._debug("signal()"),n.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),n.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(n.transceiverRequest.kind,n.transceiverRequest.init)),n.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(n.candidate):this._pendingCandidates.push(n.candidate)),n.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(n)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(d=>{this._addIceCandidate(d)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(d=>{this.destroy(f(d,"ERR_SET_REMOTE_DESCRIPTION"))}),n.sdp||n.candidate||n.renegotiate||n.transceiverRequest||this.destroy(f(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(n){var d=new this._wrtc.RTCIceCandidate(n);this._pc.addIceCandidate(d).catch(h=>{!d.address||d.address.endsWith(".local")?R("Ignoring unsupported ICE candidate."):this.destroy(f(h,"ERR_ADD_ICE_CANDIDATE"))})}send(n){this._channel.send(n)}addTransceiver(n,d){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(n,d),this._needsNegotiation()}catch(h){this.destroy(f(h,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:n,init:d}})}addStream(n){this._debug("addStream()"),n.getTracks().forEach(d=>{this.addTrack(d,n)})}addTrack(n,d){this._debug("addTrack()");var h=this._senderMap.get(n)||new Map,g=h.get(d);if(!g)g=this._pc.addTrack(n,d),h.set(d,g),this._senderMap.set(n,h),this._needsNegotiation();else throw g.removed?f(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):f(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(n,d,h){this._debug("replaceTrack()");var g=this._senderMap.get(n),w=g?g.get(h):null;if(!w)throw f(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");d&&this._senderMap.set(d,g),w.replaceTrack==null?this.destroy(f(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):w.replaceTrack(d)}removeTrack(n,d){this._debug("removeSender()");var h=this._senderMap.get(n),g=h?h.get(d):null;if(!g)throw f(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{g.removed=!0,this._pc.removeTrack(g)}catch(w){w.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(g):this.destroy(f(w,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(n){this._debug("removeSenders()"),n.getTracks().forEach(d=>{this.removeTrack(d,n)})}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,u(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}destroy(n){this._destroy(n,()=>{})}_destroy(n,d){if(!this.destroyed){if(this._debug("destroy (error: %s)",n&&(n.message||n)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(h){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(h){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,n&&this.emit("error",n),this.emit("close"),d()}}_setupData(n){if(!n.channel)return this.destroy(f(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=n.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=L),this.channelName=this._channel.label,this._channel.onmessage=h=>{this._onChannelMessage(h)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=h=>{this.destroy(f(h,"ERR_DATA_CHANNEL"))};var d=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(d&&this._onChannelClose(),d=!0):d=!1},5e3)}_read(){}_write(n,d,h){if(this.destroyed)return h(f(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(n)}catch(g){return this.destroy(f(g,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>L?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=h):h(null)}else this._debug("write before connect"),this._chunk=n,this._cb=h}_onFinish(){if(!this.destroyed){const n=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?n():this.once("connect",n)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(n=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(n.sdp=a(n.sdp)),n.sdp=this.sdpTransform(n.sdp);const d=()=>{if(!this.destroyed){var h=this._pc.localDescription||n;this._debug("signal"),this.emit("signal",{type:h.type,sdp:h.sdp})}};this._pc.setLocalDescription(n).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?d():this.once("_iceComplete",d))}).catch(h=>{this.destroy(f(h,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(n=>{this.destroy(f(n,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(n=>{n.mid||!n.sender.track||n.requested||(n.requested=!0,this.addTransceiver(n.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(n=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(n.sdp=a(n.sdp)),n.sdp=this.sdpTransform(n.sdp);const d=()=>{if(!this.destroyed){var h=this._pc.localDescription||n;this._debug("signal"),this.emit("signal",{type:h.type,sdp:h.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(n).then(()=>{this.destroyed||(this.trickle||this._iceComplete?d():this.once("_iceComplete",d))}).catch(h=>{this.destroy(f(h,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(n=>{this.destroy(f(n,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(f(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var n=this._pc.iceConnectionState,d=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",n,d),this.emit("iceStateChange",n,d),(n==="connected"||n==="completed")&&(this._pcReady=!0,this._maybeReady()),n==="failed"&&this.destroy(f(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),n==="closed"&&this.destroy(f(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(n){const d=h=>(Object.prototype.toString.call(h.values)==="[object Array]"&&h.values.forEach(g=>{Object.assign(h,g)}),h);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(h=>{var g=[];h.forEach(w=>{g.push(d(w))}),n(null,g)},h=>n(h)):0<this._pc.getStats.length?this._pc.getStats(h=>{if(!this.destroyed){var g=[];h.result().forEach(w=>{var p={};w.names().forEach(i=>{p[i]=w.stat(i)}),p.id=w.id,p.type=w.type,p.timestamp=w.timestamp,g.push(d(p))}),n(null,g)}},h=>n(h)):n(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const n=()=>{this.destroyed||this.getStats((d,h)=>{if(this.destroyed)return;d&&(h=[]);var g={},w={},p={},i=!1;h.forEach(k=>{(k.type==="remotecandidate"||k.type==="remote-candidate")&&(g[k.id]=k),(k.type==="localcandidate"||k.type==="local-candidate")&&(w[k.id]=k),(k.type==="candidatepair"||k.type==="candidate-pair")&&(p[k.id]=k)});const y=k=>{i=!0;var B=w[k.localCandidateId];B&&(B.ip||B.address)?(this.localAddress=B.ip||B.address,this.localPort=+B.port):B&&B.ipAddress?(this.localAddress=B.ipAddress,this.localPort=+B.portNumber):typeof k.googLocalAddress=="string"&&(B=k.googLocalAddress.split(":"),this.localAddress=B[0],this.localPort=+B[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var U=g[k.remoteCandidateId];U&&(U.ip||U.address)?(this.remoteAddress=U.ip||U.address,this.remotePort=+U.port):U&&U.ipAddress?(this.remoteAddress=U.ipAddress,this.remotePort=+U.portNumber):typeof k.googRemoteAddress=="string"&&(U=k.googRemoteAddress.split(":"),this.remoteAddress=U[0],this.remotePort=+U[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(h.forEach(k=>{k.type==="transport"&&k.selectedCandidatePairId&&y(p[k.selectedCandidatePairId]),(k.type==="googCandidatePair"&&k.googActiveConnection==="true"||(k.type==="candidatepair"||k.type==="candidate-pair")&&k.selected)&&y(k)}),!i&&(!Object.keys(p).length||Object.keys(w).length))return void setTimeout(n,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(k){return this.destroy(f(k,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var C=this._cb;this._cb=null,C(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};n()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>L)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(n=>{this._pc.removeTrack(n),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiate"),this.emit("negotiate"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(n){this.destroyed||(n.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:n.candidate.candidate,sdpMLineIndex:n.candidate.sdpMLineIndex,sdpMid:n.candidate.sdpMid}}):!n.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),n.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(n){if(!this.destroyed){var d=n.data;d instanceof ArrayBuffer&&(d=b.from(d)),this.push(d)}}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var n=this._cb;this._cb=null,n(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(n){this.destroyed||n.streams.forEach(d=>{this._debug("on track"),this.emit("track",n.track,d),this._remoteTracks.push({track:n.track,stream:d}),this._remoteStreams.some(h=>h.id===d.id)||(this._remoteStreams.push(d),u(()=>{this.emit("stream",d)}))})}_debug(){var n=[].slice.call(arguments);n[0]="["+this._id+"] "+n[0],x.apply(null,n)}}T.WEBRTC_SUPPORT=!!s(),T.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},T.channelConfig={},N.exports=T}).call(this)}).call(this,S("buffer").Buffer)},{buffer:4,debug:5,"err-code":7,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})});const He=0,Ye=1,at=2,ct=(m,O)=>{Z(m,He);const I=Lt(O);le(m,I)},ut=(m,O,I)=>{Z(m,Ye),le(m,Ot(O,I))},zt=(m,O,I)=>ut(O,I,Le(m)),ht=(m,O,I)=>{xt(O,Le(m),I)},Jt=(m,O)=>{Z(m,at),le(m,O)},$t=ht,Xt=(m,O,I,D)=>{const j=et(m);switch(j){case He:zt(m,O,I);break;case Ye:ht(m,I,D);break;case at:$t(m,I,D);break;default:throw new Error("Unknown message type")}return j},Zt=(m,O)=>{const I=tt(m).buffer,D=tt(O).buffer;return crypto.subtle.importKey("raw",I,"PBKDF2",!1,["deriveKey"]).then(j=>crypto.subtle.deriveKey({name:"PBKDF2",salt:D,iterations:1e5,hash:"SHA-256"},j,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},lt=(m,O)=>{if(!O)return We(m);const I=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:I},O,m).then(D=>{const j=te();return Be(j,"AES-GCM"),le(j,I),le(j,new Uint8Array(D)),re(j)})},Qt=(m,O)=>{const I=te();return Tt(I,m),lt(re(I),O)},dt=(m,O)=>{if(!O)return We(m);const I=Ue(m),D=rt(I);D!=="AES-GCM"&&Ft($e("Unknown encryption algorithm"));const j=Le(I),S=Le(I);return crypto.subtle.decrypt({name:"AES-GCM",iv:j},O,S).then(N=>new Uint8Array(N))},er=(m,O)=>dt(m,O).then(I=>Rt(Ue(new Uint8Array(I)))),ne=Nt("y-webrtc"),Ee=0,ft=3,Oe=1,Ve=4,De=new Map,be=new Map,pt=m=>{let O=!0;m.webrtcConns.forEach(I=>{I.synced||(O=!1)}),(!O&&m.synced||O&&!m.synced)&&(m.synced=O,m.provider.emit("synced",[{synced:O}]),ne("synced ",ae,m.name,Se," with all peers"))},gt=(m,O,I)=>{const D=Ue(O),j=te(),S=et(D);if(m===void 0)return null;const N=m.awareness,b=m.doc;let a=!1;switch(S){case Ee:{Z(j,Ee);const R=Xt(D,j,b,m);R===Ye&&!m.synced&&I(),R===He&&(a=!0);break}case ft:Z(j,Oe),le(j,Me(N,Array.from(N.getStates().keys()))),a=!0;break;case Oe:Dt(N,Le(D),m);break;case Ve:{const R=kt(D)===1,x=rt(D);if(x!==m.peerId&&(m.bcConns.has(x)&&!R||!m.bcConns.has(x)&&R)){const s=[],c=[];R?(m.bcConns.add(x),c.push(x)):(m.bcConns.delete(x),s.push(x)),m.provider.emit("peers",[{added:c,removed:s,webrtcPeers:Array.from(m.webrtcConns.keys()),bcPeers:Array.from(m.bcConns)}]),bt(m)}break}default:return console.error("Unable to compute message"),j}return a?j:null},tr=(m,O)=>{const I=m.room;return ne("received message from ",ae,m.remotePeerId,it," (",I.name,")",Se,st),gt(I,O,()=>{m.synced=!0,ne("synced ",ae,I.name,Se," with ",ae,m.remotePeerId),pt(I)})},Ke=(m,O)=>{ne("send message to ",ae,m.remotePeerId,Se,it," (",m.room.name,")",st);try{m.peer.send(re(O))}catch(I){}},rr=(m,O)=>{ne("broadcast message in ",ae,m.name,Se),m.webrtcConns.forEach(I=>{try{I.peer.send(O)}catch(D){}})};class yt{constructor(m,O,I,D){ne("establishing connection to ",ae,I),this.room=D,this.remotePeerId=I,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Gt({initiator:O,...D.provider.peerOpts}),this.peer.on("signal",j=>{ze(m,D,{to:I,from:D.peerId,type:"signal",signal:j})}),this.peer.on("connect",()=>{ne("connected to ",ae,I),this.connected=!0;const j=D.provider,S=j.doc,N=D.awareness,b=te();Z(b,Ee),ct(b,S),Ke(this,b);const a=N.getStates();if(a.size>0){const R=te();Z(R,Oe),le(R,Me(N,Array.from(a.keys()))),Ke(this,R)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,D.webrtcConns.has(this.remotePeerId)&&(D.webrtcConns.delete(this.remotePeerId),D.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(D.webrtcConns.keys()),bcPeers:Array.from(D.bcConns)}])),pt(D),this.peer.destroy(),ne("closed connection to ",ae,I)}),this.peer.on("close",()=>{ne("Connection to remote peer ",ae,I,Se," has been closed"),Ge(D)}),this.peer.on("error",j=>{ne("Error in connection to ",ae,I,": ",j),Ge(D)}),this.peer.on("data",j=>{const S=tr(this,j);S!==null&&Ke(this,S)})}destroy(){this.peer.destroy()}}const ye=(m,O)=>lt(O,m.key).then(I=>m.mux(()=>Kt(m.name,I))),mt=(m,O)=>{m.bcconnected&&ye(m,O),rr(m,O)},Ge=m=>{De.forEach(O=>{O.connected&&(O.send({type:"subscribe",topics:[m.name]}),m.webrtcConns.size<m.provider.maxConns&&ze(O,m,{type:"announce",from:m.peerId}))})},bt=m=>{if(m.provider.filterBcConns){const O=te();Z(O,Ve),nt(O,1),Be(O,m.peerId),ye(m,re(O))}};class nr{constructor(m,O,I,D){this.peerId=Mt(),this.doc=m,this.awareness=O.awareness,this.provider=O,this.synced=!1,this.name=I,this.key=D,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=_t(),this.bcconnected=!1,this._bcSubscriber=j=>dt(new Uint8Array(j),D).then(S=>this.mux(()=>{const N=gt(this,S,()=>{});N&&ye(this,re(N))})),this._docUpdateHandler=(j,S)=>{const N=te();Z(N,Ee),Jt(N,j),mt(this,re(N))},this._awarenessUpdateHandler=({added:j,updated:S,removed:N},b)=>{const a=j.concat(S).concat(N),R=te();Z(R,Oe),le(R,Me(this.awareness,a)),mt(this,re(R))},this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),window.addEventListener("beforeunload",()=>{ot(this.awareness,[m.clientID],"window unload"),be.forEach(j=>{j.disconnect()})})}connect(){Ge(this);const m=this.name;Yt(m,this._bcSubscriber),this.bcconnected=!0,bt(this);const O=te();Z(O,Ee),ct(O,this.doc),ye(this,re(O));const I=te();Z(I,Ee),ut(I,this.doc),ye(this,re(I));const D=te();Z(D,ft),ye(this,re(D));const j=te();Z(j,Oe),le(j,Me(this.awareness,[this.doc.clientID])),ye(this,re(j))}disconnect(){De.forEach(O=>{O.connected&&O.send({type:"unsubscribe",topics:[this.name]})}),ot(this.awareness,[this.doc.clientID],"disconnect");const m=te();Z(m,Ve),nt(m,0),Be(m,this.peerId),ye(this,re(m)),Vt(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(O=>O.destroy())}destroy(){this.disconnect()}}const ir=(m,O,I,D)=>{if(be.has(I))throw $e(`A Yjs Doc connected to room "${I}" already exists!`);const j=new nr(m,O,I,D);return be.set(I,j),j},ze=(m,O,I)=>{O.key?Qt(I,O.key).then(D=>{m.send({type:"publish",topic:O.name,data:Qe(D)})}):m.send({type:"publish",topic:O.name,data:I})};class sr extends Bt{constructor(m){super(m);this.providers=new Set,this.on("connect",()=>{ne(`connected (${m})`);const O=Array.from(be.keys());this.send({type:"subscribe",topics:O}),be.forEach(I=>ze(this,I,{type:"announce",from:I.peerId}))}),this.on("message",O=>{switch(O.type){case"publish":{const I=O.topic,D=be.get(I);if(D==null||typeof I!="string")return;const j=S=>{const N=D.webrtcConns,b=D.peerId;if(S==null||S.from===b||S.to!==void 0&&S.to!==b||D.bcConns.has(S.from))return;const a=N.has(S.from)?()=>{}:()=>D.provider.emit("peers",[{removed:[],added:[S.from],webrtcPeers:Array.from(D.webrtcConns.keys()),bcPeers:Array.from(D.bcConns)}]);switch(S.type){case"announce":N.size<D.provider.maxConns&&(Ie(N,S.from,()=>new yt(this,!0,S.from,D)),a());break;case"signal":S.to===b&&(Ie(N,S.from,()=>new yt(this,!1,S.from,D)).peer.signal(S.signal),a());break}};D.key?typeof O.data=="string"&&er(Ze(O.data),D.key).then(j):j(O.data)}}}),this.on("disconnect",()=>ne(`disconnect (${m})`))}}class or extends Xe{constructor(m,O,{signaling:I=["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"],password:D=null,awareness:j=new Pt(O),maxConns:S=20+At(It()*15),filterBcConns:N=!0,peerOpts:b={}}={}){super();this.roomName=m,this.doc=O,this.filterBcConns=N,this.awareness=j,this.shouldConnect=!1,this.signalingUrls=I,this.signalingConns=[],this.maxConns=S,this.peerOpts=b,this.key=D?Zt(D,m):We(null),this.room=null,this.key.then(a=>{this.room=ir(O,this,m,a),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect()}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(m=>{const O=Ie(De,m,()=>new sr(m));this.signalingConns.push(O),O.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(m=>{m.providers.delete(this),m.providers.size===0&&(m.destroy(),De.delete(this.roomName))}),this.room&&this.room.disconnect()}destroy(){this.key.then(()=>{this.room.destroy(),be.delete(this.roomName)}),super.destroy()}}export{or as WebrtcProvider};
